image: Visual Studio 2017

platform:
    - x64

cache:
    - examples/bs-7.0.1/node_modules/

install:
    # The x64 is required as a workaround for esy/esy#412
    - ps: Install-Product node 8 x64

build_script:
    - cd examples\bs-7.0.1
    - npm install
    - npm run build
    - cd ..\..

artifacts:
    - path: bin.exe
      name: Windows Build
      type: File

deploy:
    - provider: GitHub
      repository: jaredly/reason-language-server
      auth_token:
          secure: uD+IOsS6NN/5Y0E6FFbEhQNWCRE7Ur5cmfPAI2auvK8OCVz1ruf0rU8v8akII9hp
      draft: false
      prerelease: false
      force_update: true
      on:
          branch: master
          appveyor_repo_tag: true
